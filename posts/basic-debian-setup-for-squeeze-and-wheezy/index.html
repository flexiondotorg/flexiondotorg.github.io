<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="Blog, Podcasts, Live Streams and Videos about Linux and Open Source with a focus on Ubuntu, Debian and NixOS."><meta name=author content="Martin Wimpress"><meta name=keywords content="Debian,LXC,QEMU,KVM,Open Media Vault"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wimpress.com/104"><meta name=twitter:title content="Basic Debian Setup for Squeeze and Wheezy"><meta name=twitter:description content="Consistent server configuration for Debian Squeeze & Wheezy"><meta name=twitter:site content="@m_wimpress"><meta name=msapplication-TileColor content="#00aba9"><meta name=theme-color content="#ffffff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=preload href=/css/style.css type=text/css as=style onload='this.rel="stylesheet"'><link rel=stylesheet href=/css/style.css type=text/css media=print onload='this.media="all"'><link rel=preload href=/css/fonts.css type=text/css as=style onload='this.rel="stylesheet"'><link rel=stylesheet href=/css/fonts.css type=text/css media=print onload='this.media="all"'><link rel=preload href=/css/syntax.css type=text/css as=style onload='this.rel="stylesheet"'><link rel=stylesheet href=/css/syntax.css type=text/css media=print onload='this.media="all"'><link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css type=text/css as=font onload='this.rel="stylesheet"' crossorigin=anonymous referrerpolicy=no-referrer integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css type=text/css media=print onload='this.media="all"' crossorigin=anonymous referrerpolicy=no-referrer integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="><noscript><link rel=stylesheet href=/css/style.css type=text/css><link rel=stylesheet href=/css/fonts.css type=text/css><link rel=stylesheet href=/css/syntax.css type=text/css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css type=text/css crossorigin=anonymous referrerpolicy=no-referrer integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="></noscript><link rel=canonical href=https://wimpress.com/posts/basic-debian-setup-for-squeeze-and-wheezy/><title>Basic Debian Setup for Squeeze and Wheezy</title></head><body><nav class="navbar navbar-expand-lg bg-secondary text-uppercase fixed-top" id=mainNav><div class=container><a class=navbar-brand href=/>Martin Wimpress</a>
<button class="navbar-toggler text-uppercase font-weight-bold bg-primary text-white rounded" type=button data-bs-toggle=collapse data-bs-target=#navbarResponsive aria-controls=navbarResponsive aria-expanded=false aria-label="Toggle navigation">
Menu<em class="fas fa-bars"></em></button><div class="collapse navbar-collapse" id=navbarResponsive><ul class="navbar-nav ms-auto"><li class="nav-item mx-0 mx-lg-1"></li><a class="nav-link py-3 px-0 px-lg-3 rounded" href=https://wimpress.com/posts/>Posts</a></li><li class="nav-item mx-0 mx-lg-1"></li><a class="nav-link py-3 px-0 px-lg-3 rounded" href=https://wimpress.com/projects/>Projects</a></li></ul><form action=/search method=get><div class=input-group><input class=form-control type=search name=q id=search-query placeholder=Search....>
<button class="btn btn-primary btn-sm" id=searchButton type=submit><span class="fas fa-search"></span></button></div></form></div></div></nav><header class="masthead2 text-white text-center"></header><div class="container pb-1"><div class=row><section class="page-section portfolio col-12 col-lg-10"><img class="card-img-top img-fluid rounded mt-4" src=https://wimpress.com/posts/basic-debian-setup-for-squeeze-and-wheezy/hero.webp width=1280 height=720 alt="Consistent server configuration for Debian Squeeze & Wheezy" loading=lazy><h2 class="page-section-heading text-center text-uppercase text-secondary mt-3">Basic Debian Setup for Squeeze and Wheezy</h2><div class="divider-custom m-1"><div class=divider-custom-line></div><div class="divider-custom-icon text-secondary"><em class="fas fa-file-text"></em></div><div class=divider-custom-line></div></div><div class="row mb-2"><div class="col text-center text-nowrap"><a class=h4 href=/tags/debian/ title=Debian><span class="badge bg-primary p-2 m-1">Debian</span></a>
<a class=h4 href=/tags/kvm/ title=KVM><span class="badge bg-primary p-2 m-1">KVM</span></a>
<a class=h4 href=/tags/lxc/ title=LXC><span class="badge bg-primary p-2 m-1">LXC</span></a>
<a class=h4 href=/tags/open-media-vault/ title="Open Media Vault"><span class="badge bg-primary p-2 m-1">Open Media Vault</span></a>
<a class=h4 href=/tags/qemu/ title=QEMU><span class="badge bg-primary p-2 m-1">QEMU</span></a></div></div><div class="row justify-content-left"><div class=col-12><div class="alert alert-warning" role=alert><h4 class=alert-heading>Old post detected! <em class="fa-solid fa-book-skull"></em></h4><p>This post was last updated on August 6, 2013! The information presented here may be out of date and inaccurate.</p><hr><em class=mb-0>Please read this page but do keep its age in mind.</em></div></div><p>Recently I&rsquo;ve been deploying <a href=http://www.debian.org>Debian</a> 6.0 (Squeeze) and
7.0 (Wheezy) servers for some personal projects. These servers are provisioned
in different ways:</p><ul><li>Open Media Vault using a Squeeze pre-seed</li><li>VPS powered by <a href=http://http://lxc.sourceforge.net/>LXC</a> deployed via <code>debootstrap</code></li><li>VPS powered by <a href=http://www.linux-kvm.org>KVM</a> using the hosting providers Wheezy pre-seed</li></ul><p>Consequently the basic install differs on each instance and requires a little
bit of post install tweaking to get them all consistent. This blog post is a
quick reference for the post install steps I complete on Debian servers.</p><h1 id=timezone--locale>Timezone & Locale</h1><p>Select your timezone.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dpkg-reconfigure tzdata
</span></span></code></pre></div><p>Select your locale(s).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dpkg-reconfigure locales
</span></span></code></pre></div><p>Make sure the locales are correctly generated. Replace <code>en_GB.UTF-8</code> with your
default locale.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>update-locale <span style=color:#eedd82>LANG</span>=en_GB.UTF-8 <span style=color:#eedd82>LANGUAGE</span>=en_GB.UTF-8 <span style=color:#eedd82>LC_ALL</span>=en_GB.UTF-8 <span style=color:#eedd82>LC_TIME</span>=en_GB.UTF-8 <span style=color:#eedd82>LC_CTYPE</span>=en_GB.UTF-8
</span></span><span style=display:flex><span>locale -a
</span></span><span style=display:flex><span>locale-gen
</span></span></code></pre></div><h1 id=hostname>Hostname</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo box.example.org &gt; /etc/hostname
</span></span><span style=display:flex><span>/bin/hostname -F /etc/hostname
</span></span></code></pre></div><p>Update <code>/etc/hosts</code> accordingly.</p><h1 id=time>Time</h1><p>Keeping time is essential.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt-get install ntp ntpdate
</span></span></code></pre></div><p>Force a clock sync.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>service ntp stop
</span></span><span style=display:flex><span>ntpdate -s pool.ntp.org
</span></span><span style=display:flex><span>service ntp start
</span></span></code></pre></div><p>If your VPS is a Xen DomU then checkout the following.</p><ul><li><a href=http://jinntech.blogspot.co.uk/2009/03/xen-and-keeping-time.html>http://jinntech.blogspot.co.uk/2009/03/xen-and-keeping-time.html</a></li></ul><h1 id=essentials>Essentials</h1><p>These are the essential tools I require.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt-get install build-essential curl git htop less lsb-release nano <span style=color:#87ceeb>\
</span></span></span><span style=display:flex><span><span style=color:#87ceeb></span>rsync screen sudo tree whois
</span></span></code></pre></div><h1 id=users>Users</h1><p>The following will create a user with <code>sudo</code> capabilities.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>useradd user_a --create-home --shell /bin/bash --user-group <span style=color:#87ceeb>\
</span></span></span><span style=display:flex><span><span style=color:#87ceeb></span>--groups adm,dialout,cdrom,plugdev,sudo
</span></span></code></pre></div><p>This will create a regular user.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>useradd user_b --create-home --shell /bin/bash --user-group --groups adm,dialout,cdrom,plugdev
</span></span></code></pre></div><p>Assign a password.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo user_a:mypassword | chpasswd
</span></span></code></pre></div><p>An existing user can be made a sudoer by simply adding them to the <code>sudo</code> group.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adduser user_b sudo
</span></span></code></pre></div><h1 id=firewall>Firewall</h1><p>I use firewall my VPS server with <code>ufw</code>. This is my initial configuration that
allow access via SSH only.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get install ufw
</span></span></code></pre></div><p>Configuring <code>ufw</code> is simple but make sure you have console access to the host
you are configuring just in case you lock yourself out.</p><p><strong>NOTE!</strong> When enabling <code>ufw</code> the chains are flushed and connections may be
dropped. You can add rules to the firewall before enabling it however, so if you
are testing <code>ufw</code> on a remote machine it is recommended you perform&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ufw allow ssh/tcp
</span></span></code></pre></div><p>&mldr;before running <code>sudo ufw enable</code>. Once the firewall is enabled, adding and
removing rules will not flush the firewall, although modifying an existing rule
will.</p><p>Set the default behaviour to deny all incoming connections.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ufw default deny
</span></span></code></pre></div><p>Open up TCP port 22 but with rate limiting enabled which will deny connections
from an IP address that has attempted to initiate 6 or more connections in the
last 30 seconds. Ideal for protecting <code>sshd</code> but you should conisder other
<a href=/posts/ssh-brute-force-defense/>SSH brute force defense</a>
techniques as well.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ufw limit ssh
</span></span></code></pre></div><p>To enable the firewall you also have to do the following.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ufw enable
</span></span></code></pre></div><p>On low-end servers it might be beneficial to disable logging.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ufw logging off
</span></span></code></pre></div><p>You can see the status of the firewall using <code>sudo ufw status</code>.</p><h1 id=intrusion-prevention>Intrusion prevention</h1><p>I use either <code>denyhosts</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get install denyhosts
</span></span></code></pre></div><p>Purge entries older than 5 days, denied hosts will only be purged twice and
disable email alerts.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo sed -i <span style=color:#87ceeb>&#39;s/#PURGE_DENY = 5d/PURGE_DENY = 5d/&#39;</span> /etc/denyhosts.conf
</span></span><span style=display:flex><span>sudo sed -i <span style=color:#87ceeb>&#39;s/#PURGE_THRESHOLD = 2/PURGE_THRESHOLD = 2/&#39;</span> /etc/denyhosts.conf
</span></span><span style=display:flex><span>sudo sed -i <span style=color:#87ceeb>&#39;s/root@localhost//&#39;</span> /etc/denyhosts.conf
</span></span></code></pre></div><p>Restart <code>denyhosts</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo service denyhosts restart
</span></span></code></pre></div><p>Also see <a href=http://flexion.org/posts/2012-11-ssh-brute-force-defence.html>SSH brute force defence</a>.</p><h1 id=boot-options>Boot options</h1><p>These servers are headless and often remote, therefore I enable <code>fsck</code> auto repair.</p><h2 id=squeeze>Squeeze</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sed -i <span style=color:#87ceeb>&#39;s/FSCKFIX=no/FSCKFIX=yes/&#39;</span> /etc/default/rcS
</span></span></code></pre></div><h2 id=wheezy>Wheezy</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sed -i <span style=color:#87ceeb>&#39;s/#FSCKFIX=no/FSCKFIX=yes/&#39;</span> /etc/default/rcS
</span></span></code></pre></div><h1 id=repositories>Repositories</h1><p><code>lsb-release</code> was installed earlier. This is what I put in <code>/etc/apt/sources.list</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat &gt;/etc/apt/sources.list<span style=color:#87ceeb>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>deb http://ftp.uk.debian.org/debian/ $(lsb_release -cs) main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>deb-src http://ftp.uk.debian.org/debian/ $(lsb_release -cs) main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>deb http://security.debian.org/ $(lsb_release -cs)/updates main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>deb-src http://security.debian.org/ $(lsb_release -cs)/updates main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>
</span></span></span><span style=display:flex><span><span style=color:#87ceeb># $(lsb_release -cs)-updates, previously known as &#39;volatile&#39;
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>deb http://ftp.uk.debian.org/debian/ $(lsb_release -cs)-updates main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>deb-src http://ftp.uk.debian.org/debian/ $(lsb_release -cs)-updates main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>EOF</span>
</span></span></code></pre></div><p>I replace <code>ftp.uk</code> with <code>ftp.us</code> for servers located in the United States.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sed -i <span style=color:#87ceeb>&#39;s/ftp\.uk/ftp\.us/g&#39;</span> /etc/apt/sources.list
</span></span></code></pre></div><h2 id=backports>Backports</h2><p>I add the Backports repository in order to access some updated packages.</p><h3 id=squeeze-1>Squeeze</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat &gt;/etc/apt/sources.list.d/backports.list <span style=color:#87ceeb>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>deb http://ftp.uk.debian.org/debian-backports $(lsb_release -cs)-backports main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>deb-src http://ftp.uk.debian.org/debian-backports $(lsb_release -cs)-backports main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>EOF</span>
</span></span></code></pre></div><h3 id=wheezy-1>Wheezy</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat &gt;/etc/apt/sources.list.d/backports.list <span style=color:#87ceeb>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>deb http://ftp.uk.debian.org/debian $(lsb_release -cs)-backports main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>deb-src http://ftp.uk.debian.org/debian $(lsb_release -cs)-backports main contrib non-free
</span></span></span><span style=display:flex><span><span style=color:#87ceeb>EOF</span>
</span></span></code></pre></div><p>Update.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get update
</span></span></code></pre></div><p>All backports are deactivated by default (i.e. the packages are pinned to
100 by using ButAutomaticUpgrades: yes in the Release files. If you want to
install something from backports run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt-get -t wheezy-backports install <span style=color:#87ceeb>&#34;package&#34;</span>
</span></span></code></pre></div><h1 id=mta>MTA</h1><p>sSMTP is a simple MTA to deliver mail from a computer to a mail hub. sSMTP is
simple and lightweight.</p><h2 id=remove-exim4>Remove exim4</h2><p>Some VPS Debian templates from VPS providers have exim4 installed and running
by default. Remove it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo service exim4 stop
</span></span><span style=display:flex><span>sudo apt-get purge exim4 exim4-base exim4-config
</span></span></code></pre></div><h2 id=install-ssmtp>Install sSMTP</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt-get install ssmtp bsd-mailx
</span></span></code></pre></div><h2 id=ssmtp-gmail-configuration>sSMTP Gmail Configuration</h2><p>I use Gmail as my smart host, here is an example configuration for
<code>/etc/ssmtp/ssmtp.conf</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#0f0>#</span>
</span></span><span style=display:flex><span><span style=color:#0f0># Config file for sSMTP sendmail</span>
</span></span><span style=display:flex><span><span style=color:#0f0>#</span>
</span></span><span style=display:flex><span><span style=color:#0f0># The person who gets all mail for userids &lt; 1000</span>
</span></span><span style=display:flex><span><span style=color:#0f0># Make this empty to disable rewriting.</span>
</span></span><span style=display:flex><span><span style=color:#eedd82>root</span>=root@example.org
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#0f0># The place where the mail goes. The actual machine name is required no</span>
</span></span><span style=display:flex><span><span style=color:#0f0># MX records are consulted. Commonly mailhosts are named mail.domain.com</span>
</span></span><span style=display:flex><span><span style=color:#eedd82>mailhub</span>=smtp.gmail.com:587
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#0f0># Where will the mail seem to come from?</span>
</span></span><span style=display:flex><span><span style=color:#eedd82>rewriteDomain</span>=
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#0f0># The full hostname</span>
</span></span><span style=display:flex><span><span style=color:#eedd82>hostname</span>=box.example.org
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#0f0># Are users allowed to set their own From: address?</span>
</span></span><span style=display:flex><span><span style=color:#0f0># YES - Allow the user to specify their own From: address</span>
</span></span><span style=display:flex><span><span style=color:#0f0># NO - Use the system generated From: address</span>
</span></span><span style=display:flex><span><span style=color:#eedd82>FromLineOverride</span>=YES
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#0f0># Gmail requires TLS</span>
</span></span><span style=display:flex><span><span style=color:#eedd82>UseTLS</span>=YES
</span></span><span style=display:flex><span><span style=color:#eedd82>UseSTARTTLS</span>=YES
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#0f0># Username and password for Gmail servers</span>
</span></span><span style=display:flex><span><span style=color:#eedd82>AuthUser</span>=yourgmailname@gmail.com
</span></span><span style=display:flex><span><span style=color:#eedd82>AuthPass</span>=youpassword
</span></span><span style=display:flex><span><span style=color:#eedd82>AuthMethod</span>=LOGIN
</span></span></code></pre></div><p>Then add each account that you want to be able to send mail from by editing
<code>/etc/ssmtp/revaliases</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>root:username@gmail.com:smtp.gmail.com:587
</span></span><span style=display:flex><span>user_a:username@gmail.com:smtp.gmail.com:587
</span></span><span style=display:flex><span>user_b:username@gmail.com:smtp.gmail.com:587
</span></span></code></pre></div><ul><li><a href=https://wiki.debian.org/sSMTP>https://wiki.debian.org/sSMTP</a></li></ul><h1 id=log-and-package-monitoring>Log and package monitoring</h1><p>My personal VPS server are dotted about the place but I like to keep an eye on
them and I find <code>apticron</code> and <code>logwatch</code> are very useful for that.</p><h2 id=apticron>apticron</h2><p>apticron is a simple tool to mail about pending package updates.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get install apticron
</span></span></code></pre></div><h2 id=logwatch>logwatch</h2><p>Logwatch is a modular log analyser that runs every night and mails you the results.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get install logwatch
</span></span></code></pre></div><h1 id=lighter>Lighter</h1><p>Some of my servers have fairly low resources, these are some simple changes that
can save a bit of RAM or disk space.</p><h2 id=aptitude>aptitude</h2><p>I don&rsquo;t use it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get purge aptitude
</span></span></code></pre></div><h2 id=d-bus>D-Bus</h2><p>D-Bus is a message bus, used for sending messages between applications.
Some VPS provider Debian templates have D-Bus and avahi installed. I don&rsquo;t
require these on Internet facing servers so I remove them. If an application
pull in D-Bus as a requirement that is fine, but for this initial server
state I remove it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get purge dbus
</span></span></code></pre></div><h2 id=at>at</h2><p><code>at</code> provides delayed job execution and batch processing. I don&rsquo;t use it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo service atd stop
</span></span><span style=display:flex><span>sudo apt-get purge at
</span></span></code></pre></div><h2 id=ngetty>ngetty</h2><p>Ngetty is a single-process <code>getty</code> replacement, so instead of running 6 <code>getty</code>
processes consuming up to 3MB of RAM each, you can use a single <code>ngetty</code> process
using less than 1MB of RAM total.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get install ngetty
</span></span></code></pre></div><p>Edit <code>/etc/inittab</code>, comment out <code>getty</code> and add <code>ngetty</code> like so.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#1:2345:respawn:/sbin/getty 38400 tty1
</span></span><span style=display:flex><span>#2:23:respawn:/sbin/getty 38400 tty2
</span></span><span style=display:flex><span>#3:23:respawn:/sbin/getty 38400 tty3
</span></span><span style=display:flex><span>#4:23:respawn:/sbin/getty 38400 tty4
</span></span><span style=display:flex><span>#5:23:respawn:/sbin/getty 38400 tty5
</span></span><span style=display:flex><span>#6:23:respawn:/sbin/getty 38400 tty6
</span></span><span style=display:flex><span>ng:2345:respawn:/sbin/ngetty 1 2 3 4 5 6
</span></span></code></pre></div><p>Restart inittab</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>telinit q
</span></span></code></pre></div><ul><li><a href=http://haydenjames.io/replacing-getty-ngetty-debian/>http://haydenjames.io/replacing-getty-ngetty-debian/</a></li></ul><p>That about covers the general post installation step I complete on my Debian
servers.</p><h2 id=clean-up>Clean up.</h2><p>Remove any packages that are no longer required and clean up
the package cache.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get autoremove
</span></span><span style=display:flex><span>sudo apt-get autoclean
</span></span><span style=display:flex><span>sudo apt-get clean
</span></span></code></pre></div><div class="col-5 mt-2 mb-2 text-left"><a class="btn btn-primary btn-lg col-12" href=https://wimpress.com/posts/setting-up-open-media-vault-on-the-hp-microserver-n54l/><span class=h2><em class="fa fa-chevron-circle-left" aria="Setting up Open Media Vault on the HP MicroServer N54L"></em></span></a></div><div class="col-2 text-center"></div><div class="col-5 mt-2 mb-2 text-right"><a class="btn btn-primary btn-lg col-12" href=https://wimpress.com/posts/nfs-and-cifs-mounts-with-systemd/><span class=h2><em class="fa fa-chevron-circle-right" aria="NFS and CIFS mounts with systemd"></em></span></a></div><script src=https://giscus.app/client.js data-repo=flexiondotorg/flexiondotorg.github.io data-repo-id=R_kgDOIoJw9g data-category="Blog Comments" data-category-id=DIC_kwDOIoJw9s4CTG_3 data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=light data-lang crossorigin=anonymous async></script></div></section><section class="page-section portfolio col-12 col-lg-2 my-3"><div id=sidebar class=fixed><div class="widget pt-2"><h4 class="mb-1 widget-title text-secondary">Latest Posts</h4><ul class=list-unstyled><li class="d-flex my-1"><a href=https://wimpress.com/posts/creating-production-ready-containers-advanced-techniques/><h5>Creating Production-Ready Containers - Advanced Techniques</h5></a></li><li class="d-flex my-1"><a href=https://wimpress.com/posts/creating-production-ready-containers-the-basics/><h5>Creating Production-Ready Containers - The Basics</h5></a></li><li class="d-flex my-1"><a href=https://wimpress.com/posts/diy-snes-classic/><h5>DIY SNES Classic</h5></a></li></ul></div><div class="widget pt-2"><h4 class="mb-1 widget-title text-secondary">Related Posts</h4><ul class=list-unstyled><li class="d-flex my-1"><a href=https://wimpress.com/posts/plex-media-server-on-open-media-vault/><h5>Plex Media Server on Open Media Vault</h5></a></li><li class="d-flex my-1"><a href=https://wimpress.com/posts/setting-up-minidlna-on-open-media-vault/><h5>Setting up MiniDLNA on Open Media Vault</h5></a></li><li class="d-flex my-1"><a href=https://wimpress.com/posts/setting-up-open-media-vault-on-the-hp-microserver-n54l/><h5>Setting up Open Media Vault on the HP MicroServer N54L</h5></a></li></ul></div></div></section></div></div><footer class="footer text-center"><div class=container><div class=row><div class="col-lg-4 mb-5 mb-lg-0"><h3 class="text-uppercase mb-2">Social</h3><a class="btn btn-outline-light btn-social mx-1" href=https://wimpysworld.io/discord aria-label=discord target=_blank rel="noopener noreferrer"><em class="fab fa-fw fa-discord"></em></a>
<a class="btn btn-outline-light btn-social mx-1" href=https://fosstodon.org/@wimpy aria-label=mastodon target=_blank rel="noopener noreferrer"><em class="fab fa-fw fa-mastodon"></em></a>
<a class="btn btn-outline-light btn-social mx-1" href=https://twitter.com/m_wimpress aria-label=twitter target=_blank rel="noopener noreferrer"><em class="fab fa-fw fa-twitter"></em></a>
<a class="btn btn-outline-light btn-social mx-1" href=https://linkedin.com/in/martinwimpress aria-label=linkedin target=_blank rel="noopener noreferrer"><em class="fab fa-fw fa-linkedin"></em></a></div><div class="col-lg-4 mb-5 mb-lg-0"><h3 class="text-uppercase mb-2">Code</h3><a class="btn btn-outline-light btn-social mx-1" href=https://github.com/flexiondotorg aria-label=github target=_blank rel="noopener noreferrer"><em class="fab fa-fw fa-github"></em></a>
<a class="btn btn-outline-light btn-social mx-1" href=https://launchpad.net/~flexiondotorg aria-label=ubuntu target=_blank rel="noopener noreferrer"><em class="fab fa-fw fa-ubuntu"></em></a></div><div class=col-lg-4><h3 class="text-uppercase mb-2">Content</h3><a class="btn btn-outline-light btn-social mx-1" href=https://instagram.com/WimpysWorld aria-label=instagram target=_blank rel="noopener noreferrer"><em class="fab fa-fw fa-instagram"></em></a>
<a class="btn btn-outline-light btn-social mx-1" href=https://twitch.tv/WimpysWorld aria-label=twitch target=_blank rel="noopener noreferrer"><em class="fab fa-fw fa-twitch"></em></a>
<a class="btn btn-outline-light btn-social mx-1" href=https://youtube.com/WimpysWorld aria-label=youtube target=_blank rel="noopener noreferrer"><em class="fab fa-fw fa-youtube"></em></a>
<a class="btn btn-outline-light btn-social mx-1" href=https://linuxdowntime.com aria-label=podcast target=_blank rel="noopener noreferrer"><em class="fas fa-fw fa-podcast"></em></a></div></div></div></footer><div class="copyright py-4 text-center text-white"><div class=container><small>Copyright &copy; Martin Wimpress 2022</small></div></div><script defer src=https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.min.js type=text/javascript integrity="sha512-OvBgP9A2JBgiRad/mM36mkzXSXaJE9BEIENnVEmeZdITvwT09xnxLtT4twkCa8m/loMbPHsvPl0T8lRGVBwjlQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script defer src=/js/scripts.js type=text/javascript></script></body></html>